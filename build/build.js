!function e(t,o,n){function r(a,s){if(!o[a]){if(!t[a]){var c="function"==typeof require&&require;if(!s&&c)return c(a,!0);if(i)return i(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var u=o[a]={exports:{}};t[a][0].call(u.exports,function(e){var o=t[a][1][e];return r(o?o:e)},u,u.exports,e,t,o,n)}return o[a].exports}for(var i="function"==typeof require&&require,a=0;a<n.length;a++)r(n[a]);return r}({1:[function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){console.log("Binding 正在启动..."),console.log("数据参数对象:",e),this.$options=e,this.$data=e.data;var t=document.querySelector(this.$options.el);return t?(this._init(t),(0,c.default)(this.$data),void(0,a.default)(e,this)):void console.error("[Binding warn] "+this.$options.el+" is not exist")}var i=e("./Compiler"),a=n(i),s=e("./Observer"),c=n(s),l=e("./Watcher"),u=n(l);window.Binding=r;var d=r.prototype;d._init=function(e){var t=this;this.$options.el=e,Object.keys(t.$data).forEach(function(e){t._proxy(e)})},d.$watch=function(e,t){new u.default(this,e,t)},d._proxy=function(e){console.log("[Binding.prototype] proxy");var t=this;Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:function(){return t.$data[e]},set:function(o){t.$data[e]=o}})}},{"./Compiler":2,"./Observer":4,"./Watcher":7}],2:[function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t){console.log("正在创建[指令解析器]..."),console.log("数据参数对象:",e,"Binding 实例",t);var o=e.el;this.$el=c(o)?o:document.querySelector(o),this.$data=e.$data,this.$vm=t,this.mount()}function i(e){for(var t,o=document.createDocumentFragment();t=e.firstChild;)o.appendChild(t);return o}function a(e){return 0===e.indexOf("v-")}function s(e){return 0===e.indexOf("on")}function c(e){return e&&1===e.nodeType}function l(e){return e&&3===e.nodeType}function u(e,t){new r(e,t)}Object.defineProperty(o,"__esModule",{value:!0}),o.default=u;var d=e("./Parser"),f=n(d);r.prototype={mount:function(){var e=i(this.$el);this.compile(e),this.$el.appendChild(e)},compile:function(e){console.log("[Compiler.prototype] 开始解析(compile)",e);var t=e.childNodes,o=this;Array.prototype.slice.call(t).forEach(function(e){var t=e.textContent,n=/\{\{(.*)\}\}/;c(e)?o.parse(e):l(e)&&n.test(t)&&o.parseText(e,RegExp.$1),e.childNodes&&e.childNodes.length>0&&o.compile(e)})},parse:function(e){console.log("[Compiler.prototype] 解析元素节点(parse)");var t=e.attributes,o=this;Array.prototype.slice.call(t).forEach(function(t){var n=t.name;if(a(n)){var r=t.value,i=n.substring(2);s(i)?f.default._eventHandler(e,o.$vm,r,i):f.default[i]?f.default[i](e,o.$vm,r):console.error("[Binding error] v-"+i+" is not supported")}})},parseText:function(e,t){console.log("[Compiler.prototype] 解析元素节点(parseText)"),f.default.text(e,this.$vm,t)}}},{"./Parser":5}],3:[function(e,t,o){"use strict";function n(e){console.log("正在创建[依赖收集器]...","key",e),this.id=r++,this.watchers=[],this.watcher=null}Object.defineProperty(o,"__esModule",{value:!0}),o.default=n;var r=0;n.prototype={addWatcher:function(e){console.log("[Observer Depend.prototype] addWatcher"),this.watchers.push(e)},depend:function(){console.log("[Observer Depend.prototype] depend"),n.watcher.addDepend(this)},notify:function(){console.log("[Observer Depend.prototype] notify"),console.log("watchers",this.watchers),this.watchers.forEach(function(e){e.update()})}}},{}],4:[function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e){"object"===("undefined"==typeof e?"undefined":a(e))&&(console.log("正在创建[事件监听器]..."),console.log("被监听数据：",e),this.$data=e,this.observeObj(e))}function i(e){if(e)return new r(e)}Object.defineProperty(o,"__esModule",{value:!0});var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};o.default=i;var s=e("./Depend"),c=n(s);r.prototype={observeObj:function(e){console.log("[Observer.prototype] observeObj");var t=this;Object.keys(e).forEach(function(o){t.defineProperty(t.$data,o,e[o])})},defineProperty:function(e,t,o){var n=new c.default(t),r=i(o);Object.defineProperty(e,t,{enumerable:!0,configurable:!1,get:function(){return console.log("[Observer.prototype] defineProperty:Depend.watcher",c.default.watcher),c.default.watcher&&n.depend(),o},set:function(e){e!==o&&(o=e,r=i(e),n.notify())}})}}},{"./Depend":3}],5:[function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(o,"__esModule",{value:!0});var r=e("./Updater"),i=n(r),a=e("./Watcher"),s=n(a),c={text:function(e,t,o){this._bind(e,t,o,"text")},html:function(e,t,o){this._bind(e,t,o,"html")},model:function(e,t,o){this._bind(e,t,o,"model");var n=this,r=this._getValue(t,o);e.addEventListener("input",function(e){var i=e.target.value;r!==i&&(n._setValue(t,o,i),r=i)})},class:function(e,t,o){this._bind(e,t,o,"class")},_bind:function(e,t,o,n){var r=i.default[n];r&&(r(e,this._getValue(t,o)),new s.default(t,o,function(t,o){r(e,t,o)}))},_eventHandler:function(e,t,o,n){console.log("[Compiler DirectiveParsers] eventHandler");var r=n.split(":")[1],i=t.$options.methods&&t.$options.methods[o];r&&i?e.addEventListener(r,i.bind(t),!1):r?console.error("[Binding error] event's function or function name is not defined"):console.error("[Binding error] eventType after : is not defined")},_getValue:function(e,t){var o=e.$data;return t=t.split("."),t.forEach(function(e){o=o[e]}),o},_setValue:function(e,t,o){var n=e.$data;t=t.split("."),t.forEach(function(e,r){r<t.length-1?n=n[e]:n[e]=o})}};o.default=c},{"./Updater":6,"./Watcher":7}],6:[function(e,t,o){"use strict";Object.defineProperty(o,"__esModule",{value:!0});var n={text:function(e,t){console.log("[Updater] v-text",t),e.textContent="undefined"==typeof t?"":t},html:function(e,t){console.log("[Updater] v-html",e,t),e.innerHTML="undefined"==typeof t?"":t},class:function(e,t,o){console.log("[Updater] v-class",e,o,"->",t);var n=e.className;n=n.replace(o,"").replace(/\s$/,"");var r=n&&String(t)?" ":"";e.className=n+r+t},model:function(e,t){console.log("[Updater] v-model",e,t),e.value="undefined"==typeof t?"":t}};o.default=n},{}],7:[function(e,t,o){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}function r(e,t,o){console.log("正在创建[数据订阅器]...","vm:",e," expression:",t," callback:",o),this.vm=e,this.callback=o,this.expression=t,this.depIds={},this.value=this._getValue()}Object.defineProperty(o,"__esModule",{value:!0}),o.default=r;var i=e("./Depend"),a=n(i);r.prototype={update:function(){console.log("[Watcher.prototype] update");var e=this._getValue(),t=this.value;e!==t&&(console.log("[Watcher.prototype] value:",t,"->",e),this.value=e,this.callback.call(this.vm,e,t))},addDepend:function(e){console.log("[Watcher.prototype] addDepend"),this.depIds.hasOwnProperty(e.id)||(e.addWatcher(this),this.depIds[e.id]=e)},_beforeGet:function(){a.default.watcher=this,console.log("[Watcher.prototype] _beforeGet watcher",this)},_getValue:function(){this._beforeGet();var e=this.expression.split("."),t=this.vm.$data;return e.forEach(function(e){t=t[e]}),this._afterGet(),t},_afterGet:function(){a.default.watcher=null}}},{"./Depend":3}]},{},[1]);
//# sourceMappingURL=build.js.map
